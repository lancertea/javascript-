<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>变量及作用域</title>
</head>
<script>
    // ES5 中常量的写法

    Object.defineProperty(window, "PI2", {
        value: 3.1415926,
        writable: false
    })

    console.log(window.PI2)

    // ES6 的常量写法

    const PI = 3.1415926
    console.log(PI)

    // PI = 4


    // 作用域
    //ES5:只有两种作用域： 全局与函数内的局部作用域
    {
        { //变量i是var命令声明的，在全局范围内都有效，所以全局只有一个变量i。
            for (var i = 0; i < 3; i++) {
                setTimeout(function () {
                    console.log(i); //3 3 3

                }, 100);
            }

        }
        //ES6:块级作用域
        {
            for (let i = 0; i < 3; i++) {
                setTimeout(function () {
                    console.log(i); // 0 1 2

                }, 100);
            }
        }

        { //注意这里，只有异步才会出现这种情况
            for (var i = 0; i < 3; i++) {
                console.log(i); //0,1,2

            }

            for (let i = 0; i < 3; i++) {
                console.log(i); //0,1,2

            }

        }

        {
            //立即执行函数（闭包）
            for (var i = 0; i < 3; i++) {
                // (function(){})();
                (function (j) { //j为形参
                    setTimeout(function () {
                        console.log(j); //0 1 2
                    }, 100);
                })(i); //i为实参

            }
        }
    }

    //全局变量和全局属性不是一回事
    {
        var num = 123;
        num1 = 345;
        //全局变量不能被delete删除
        console.log(delete num); //false
        console.log(num); //123
        //全局属性可以被delete删除
        console.log(delete num1); //true
        //console.log(num1);//ReferenceError: num1 is not defined

        a();
        console.log(abc); //1  执行才有

        function a() {
            abc = 1;
        }
        //a();//ReferenceError: abc is not defined

    }

    {
        var foo = 1;

        function bar() {
            if (!foo) {
                var foo = 10;
            }
            console.log(foo); //10
        }
        bar();
    }

    {
        let foo = 1;

        function bar() {
            if (!foo) {
                let foo = 10;
            }
            console.log(foo); //1
        }
        bar();
    }

    //for:设置循环变量的那部分是一个父作用域，而循环体内部是一个单独的子作用域。
    {
        for (var i = 0; i < 3; i++) {
            console.log(i); //0 1 2
        }
    }

    {
        for (var i = 0; i < 3; i++) {
            var i = 12;
            console.log(i); //12
        }
    }

    {
        for (let i = 0; i < 3; i++) {
            console.log(i); //0 1 2
        }
    }

    {
        for (let i = 0; i < 3; i++) {
            let i = 12;
            console.log(i); //12 12 12
        }
    }
</script>

<body>

</body>

</html>