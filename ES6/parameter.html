<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>默认参数</title>
</head>
<script>
  {
    // ES5\ES3 默认参数的写法
    function f(x, y, z) {
      if (y === undefined) {
        y = 7;
      }
      if (z === undefined) {
        z = 42
      }
      return x + y + z
    }
    console.log(f(1)); //50
    console.log(f(1, 3)); //46
  }

  {
    function a(x, y) {
      x = x || '123';
      y = y || '456';
      //x=''||'123'=false||'123'='123'
      return x+y;
    }
    console.log(a('')); //'123456'

  }



  {
    // ES6 默认参数
    //ES6 内部使用严格相等运算符（===），判断一个位置是否有值。所以，只有当一个数组成员严格等于undefined，默认值才会生效。
    //一般默认值尽量往后放
    function f(x, y = 7, z = 42) {
      return x + y + z
    }
    console.log(f(1, 3)); //46
    console.log(f(1, undefined, 43)); //51

    //默认值可以是表达式,但是表达式中的变量必须是已经初始化过的
    // function f (x, y = 7, z = x + y) {
    //   console.log(f.length)
    //   return x * 10 + z
    // }

  }
  
  //参数变量x是默认声明的，在函数体中，不能用let或const再次声明，否则会报错。
  //function (x){
  // let x=1;}
  //使用参数默认值时，函数不能有同名参数。
  //function (x,x,y){
  // }
  
  
  // 必填参数的检查
  {
    function checkParameter() {
      throw new Error('can\'t be empty')
    }

    function f(x = checkParameter(), y = 7, z = 42) {
      return x + y + z
    }
    console.log(f(1)); //50
    try {
      f()
    } catch (e) {
      console.log(e);
    } finally {}
  }
  //可选参数
  {
    function sum(x, y, {
      m,
      n
    } = {}) {
      console.log(x, y, m, n);
    }
    sum(1, 2); //1 2 undefined undefined
  }
  
/*
// 写法一
function m1({x = 0, y = 0} = {}) {
  return [x, y];
}

// 写法二
function m2({x, y} = { x: 0, y: 0 }) {
  return [x, y];
}
  
// 函数没有参数的情况
m1() // [0, 0]
m2() // [0, 0]

// x 和 y 都有值的情况
m1({x: 3, y: 8}) // [3, 8]
m2({x: 3, y: 8}) // [3, 8]

// x 有值，y 无值的情况
m1({x: 3}) // [3, 0]
m2({x: 3}) // [3, undefined]

// x 和 y 都无值的情况
m1({}) // [0, 0];
m2({}) // [undefined, undefined]

m1({z: 3}) // [0, 0]
m2({z: 3}) // [undefined, undefined] 
*/
  
//参数默认值的位置：通常情况下，定义了默认值的参数，应该是函数的尾参数。如果非尾部的参数设置默认值，实际上这个参数是没法省略的。除非显式赋值为undefined
//length属性的返回值，等于函数的参数个数减去指定了默认值的参数个数。  rest 参数也不会计入length属性。

  //如何处理不确定参数的问题
  {
    // 不确定参数有几个，但是要对他们求和  
    // ES3,ES5 
    //arguments：实参长度
    function f() {
      var sum = 0;
      //[].forEach.call(arguments,item=>{});
      Array.prototype.forEach.call(arguments, function (item) {
        sum += item * 1;
      });
      return sum;
    }
    console.log(f(1, 2, 3, 6)); //12
    
    //ES6
    function f1(...arg){
    var sum=0;
    arg.forEach(item=>{
    sum+=item;
    });
    return sum;
    }
     console.log(f1(1, 2, 3, 6)); //12
  }

  {
    // ES6 可变参数
    //函数名.length只能确定没有默认值的参数的个数
    //...
    function sum1(x, y, z = 0) {
      return x + y + z;
    }
    console.log(sum1.length); //2
  }

  {
    // ES5 合并数组
    var params = ['hello', true, 7];
    var other = [1, 2].concat(params);
    console.log(other); //[ 1, 2, "hello", true, 7 ]
  }

  //rest参数的逆运算
  // function sum(x = 1, y = 2, z = 3) {
  //   return x + y + z
  // }
  // let data = [4, 5, 9]
  // //ES5
  // // console.log(sum(data[0], data[1], data[2]))
  // // console.log(sum.apply(this, data))
  // // ES6  spread
  // console.log(sum(...data))

  {
    // ES6 利用扩展运算符合并数组
    var params = ['hello', true, 7];
    var other = [
      1, 2, ...params
    ];
    console.log(other); //[ 1, 2, "hello", true, 7 ]
  }

     //一旦设置了参数的默认值，函数进行声明初始化时，参数会形成一个单独的作用域（context）。等到初始化结束，
        //这个作用域就会消失。这种语法行为，在不设置参数默认值时，是不会出现的。
        // var x = 1;
        // function f(x, y = x) {
        //     console.log(y);
        // }
        // f(2) // 2

        // let x = 1;
        // function f(y = x) {
        //     let x = 2;
        //     console.log(y);
        // }
        // f() // 1

 
</script>

<body>

</body>

</html>
